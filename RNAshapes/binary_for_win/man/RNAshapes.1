.\" Automatically generated by Pod::Man v1.34, Pod::Parser v1.13
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sh \" Subsection heading
.br
.if t .Sp
.ne 5
.PP
\fB\\$1\fR
.PP
..
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  | will give a
.\" real vertical bar.  \*(C+ will give a nicer C++.  Capital omega is used to
.\" do unbreakable dashes and therefore won't be available.  \*(C` and \*(C'
.\" expand to `' in nroff, nothing in troff, for use with C<>.
.tr \(*W-|\(bv\*(Tr
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` <
.    ds C' >
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
'br\}
.\"
.\" If the F register is turned on, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.Sh), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.if \nF \{\
.    de IX
.    tm Index:\\$1\t\\n%\t"\\$2"
..
.    nr % 0
.    rr F
.\}
.\"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.hy 0
.if n .na
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.IX Title "RNASHAPES 1"
.TH RNASHAPES 1 "04/15/08" "RNAshapes 2.1.5" "RNAshapes documentation"
.SH "NAME"
RNAshapes \- RNA Analysis based on Abstract Shapes
.SH "SYNOPSIS"
.IX Header "SYNOPSIS"
RNAshapes [\fB\-h\fR] [\fB\-a\fR] [\fB\-s\fR] [\fB\-p\fR] [\fB\-i\fR \f(CW\*(C`sampling iterations\*(C'\fR] \f(CW\*(C`input sequence\*(C'\fR
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
This manual describes RNAshapes, a software package that integrates
three \s-1RNA\s0 analysis tools based on the abstract shapes approach
(Steffen et al. 2005): the analysis of shape representatives
(Giegerich et al. 2004), the calculation of shape probabilities (Voss
et al. 2005), and the consensus shapes approach (Reeder and Giegerich
2005). This new package is completely reimplemented in C, and outruns
the original implementations significantly in runtime and memory
requirements.  Additionally, we added a number of useful features like
suboptimal folding with correct dangling energies, structure graph
output, shape matching, and a sliding window approach.
.PP
In the following, we will shortly review the notion of abstract
shapes, and explain where its power comes from. We will then provide
an overview of the problems that can be approached in the new way.
.Sh "The abstract shapes approach"
.IX Subsection "The abstract shapes approach"
An \s-1RNA\s0 shape is an abstract representation of an \s-1RNA\s0 secondary
structure.  It is inspired by the dot-bracket representation known
from the Vienna \s-1RNA\s0 package (Hofacker et al. 1994). Consider the
following sequence and two secondary structures from its folding space
in dot-bracket representation:
.PP
.Vb 3
\&  AUCGGCGCACAGGACAUCCUAGGUACAAGGCCGCCCGUU
\&  ..(((.((..(((....))).(((.....))))))))..
\&  ..(((.....(((....))).(((.....)))..)))..
.Ve
.PP
The shapes approach offers five abstraction levels (or \fIshape types\fR)
ordered in their degree of abstraction. Common to all levels is that
they abstract from loop and stack lengths, where unpaired regions are
represented by an underscore and stacking regions by a pair of squared
brackets.  This is the least abstract shape type 1, so the two example
secondary structures become:
.PP
.Vb 2
\&  _[_[_[_]_[_]]]_
\&  _[_[_]_[_]_]_
.Ve
.PP
The succeeding shape types gradually increase abstraction, ending in
type 5, where no unpaired regions are included and nested helices are
combined. In this type, our example structures are both represented
as:
.PP
.Vb 1
\&  [[][]]
.Ve
.PP
These abstractions form the basis of all applications of \s-1RNA\s0 abstract
shape analysis. In the following we give an overview of the main
applications, all integrated in the RNAshapes package.
.Sh "Shape representative analysis"
.IX Subsection "Shape representative analysis"
Current \s-1RNA\s0 folding algorithms either calculate a single, minimum free
energy prediction, or a huge number of suboptimal structures, most of
which are quite similar and therefore redundant. With shapes, we
abstract from the concrete secondary structures and only consider
classes of structures that fall into different shapes. The \fIshape
representative\fR (in short: \fIshrep\fR) of a shape is the structure with
the minimum free energy inside a shape class.
.Sh "Shape probabilities"
.IX Subsection "Shape probabilities"
In (Voss et al. 2005), we extended the shapes approach to the
computation of shape probabilities. The probability of a shape is the
sum of the probabilities of all structures that fall into this shape.
Several analyses indicate that this approach is quite effective.  For
example, an analysis of a conformational switch shows the existence of
two shapes with probabilities approximately 2/3 vs. 1/3, whereas the
analysis of a micro \s-1RNA\s0 precursor reveals the hairpin shape with a
probability near to 1.0 (Voss et al. 2005).
.PP
RNAshapes contains three approaches for probability analysis, suitable
for different input sizes: Complete probability analysis, sampling
shapes probability analysis, and fast high probability shape analysis.
.Sh "Consensus shapes"
.IX Subsection "Consensus shapes"
The well-known Sankoff algorithm (Sankoff 1985) for simultaneous \s-1RNA\s0
sequence alignment and folding is currently considered an ideal, but
computationally over-expensive method. Available tools implement this
algorithm under various pragmatic restrictions.  In (Reeder and
Giegerich 2005), we proposed to redefine the consensus structure
prediction problem in a way that does not imply a multiple sequence
alignment step. For a family of \s-1RNA\s0 sequences, our method RNAcast
explicitly and independently enumerates the near-optimal abstract
shape space, and predicts as the consensus an abstract shape common to
all sequences.  For each sequence, it delivers the thermodynamically
best structure that has this common shape. Since the shape space is
much smaller than the structure space, and identification of common
shapes can be done in linear time (in the number of shapes
considered), the method is essentially linear in the number of
sequences. Our evaluation showed that the new method compares favorably
with available alternatives (Reeder and Giegerich 2005). It is
particularly useful on sequences with low conservation, where methods
based on sequence alignment cannot be employed. We have now integrated
RNAcast into the RNAshapes package.
.SH "INPUT"
.IX Header "INPUT"
As input, RNAshapes accepts a plain single sequence, or multiple
sequences in fasta format. When given multiple sequences, each
sequence is processed separately in the order of input. 
.PP
Input can be given by four different ways:
.PP
\&\- Command line parameter, e.g.:
.PP
.Vb 1
\&    RNAshapes GAGCCTGGGAGCTCTCTGGCTAACTGGGAACCCACTGCTTAAGCC
.Ve
.PP
\&\- Console standard input, e.g.:
.PP
.Vb 2
\&    echo GAGCTCTCTGGCTAACTGGGAACCCACTGCTTAAGCC | RNAshapes
\&    RNAshapes < sequences.fasta
.Ve
.PP
\&\- File input with option \fB\-f\fR, e.g.:
.PP
.Vb 1
\&    RNAshapes -f sequences.fasta
.Ve
.PP
\&\- Interactive input. To activate this mode, start RNAshapes without giving any input sequences.
.PP
Valid characters in an input sequence are \*(L"\s-1ACGU\s0\*(R" and \*(L"acgu\*(R". \*(L"T\*(R" and
\&\*(L"t\*(R" will be converted to \*(L"U\*(R". Other letters are mapped to \*(L"N\*(R" and will
not be paired. All other characters are ignored.
.SH "OPTIONS"
.IX Header "OPTIONS"
\&\fB\-h\fR       Display command option overview
.PP
\&\fB\-H\fR \f(CW\*(C`option\*(C'\fR Display detailed information on \f(CW\*(C`option\*(C'\fR
.PP
This displays the corresponding section of the RNAshapes manual for
the given command line option.
.PP
\&\fB\-v\fR       Show version
.PP
This shows the version number of RNAshapes.
.Sh "Sequence analysis modes"
.IX Subsection "Sequence analysis modes"
\&\fB\-a\fR       Shape folding (standard mode)
.PP
\&\s-1RNA\s0 folding based on abstract shapes. This is the standard mode of
operation when no other options are given. It calculates the shapes
and the corresponding shreps based on free energy minimization. The
energy range can be set by \fB\-e\fR and \fB\-c\fR. When not specified, the
energy range is set to 10% of the minimum free energy.
.PP
\&\fB\-s\fR       Complete suboptimal folding
.PP
Complete suboptimal folding of \s-1RNA\s0. This mode uses a non-ambiguous
grammar that also handles dangling bases of multiloop components in a
non-ambiguous way. The energy range can be set by \fB\-e\fR and
\&\fB\-c\fR. When not specified, the energy range is set to 10% of the
minimum free energy.
.PP
\&\fB\-p\fR       Shape probabilities
.PP
Shape probability mode. This option calculates the shape probabilities
based on partition function. The probability of a shape is the sum of
the probabilities of all structures that fall into this shape. On a
computer with 2GB main memory, sequences up to a length of 300 bases
can be processed with this mode.
.PP
\&\fB\-q\fR       Shape probabilities (including shreps)
.PP
Shape probability mode. Calculates the shape probabilities based on
partition function. This is the same as \fB\-p\fR, and additionally, the
corresponding shreps with their minimum free energies are
calculated. Note that this mode is slightly slower than \fB\-p\fR and can
be used with sequences up to a length of 250 bases.
.PP
\&\fB\-P\fR \f(CW\*(C`value\*(C'\fR Shape probabilities for mfe-best shapes
.PP
Shape probability mode. This mode first calculates the best \f(CW\*(C`value\*(C'\fR
shapes based on free energy minimization. In a second step, it
calculates the probability for each of these best shapes. This mode
has lower memory requirements than modes \fB\-p\fR and \fB\-q\fR and can be
used for longer sequences (up to 500 bases).  The energy range must be
specified with \fB\-e\fR or \fB\-c\fR in order to get the desired number of
results.
.PP
\&\fB\-i\fR \f(CW\*(C`value\*(C'\fR Sampling with \f(CW\*(C`value\*(C'\fR iterations
.PP
Probabilistic sampling based on partition function.  This mode
combines stochastic sampling with a\-posteriori shape abstraction. A
sample from the structure space holds M structures together with their
shapes, on which classification is performed. The probability of a
shape can then be approximated by its frequency in the sample.
.PP
Sequences up to a length of around 1500 can be handled with this mode.
In our experience, 1000 iterations are sufficient to achieve
reasonable results for shapes with high probability.
.PP
\&\fB\-C\fR       Consensus shapes (RNAcast) 
.PP
For a family of \s-1RNA\s0 sequences, this method independently enumerates
the near-optimal abstract shape space, and predicts as the consensus
an abstract shape common to all sequences.  For each sequence, it
delivers the thermodynamically best structure which has this common
shape. Since the shape space is much smaller than the structure space,
and identification of common shapes can be done in linear time (in the
number of shapes considered), the method is essentially linear in the
number of sequences.
Input for RNAcast must be provided in multiple fasta format, e.g.:
.PP
.Vb 7
\&  cat test.fasta
\&  >seq1
\&  CACACAAAGGCAGCGGAACCCCCCUCCUGGUAACAGGAGCCU
\&  >seq2
\&  AGGCAGCGGAAAUCCCCACCUGGUAACAGGUGCCUCUGC
\&  >seq3
\&  CCUUUGCAGGCAGCGGAAUCCCCCACCUGGUGACAGGUGCCU
.Ve
.PP
The output of RNAcast first shows the common shape, the score (the sum
of the structure energies), and the ratio of the score to the sum of
all mfe values. A ratio near 1.0 means a good conservation, a lower
ratio means less conservation. Then, for each input \s-1RNA\s0 the predicted
shrep, its energy, and its individual rank (R = ...) in the shape
space is printed:
.PP
.Vb 11
\&  RNAshapes -f test.fasta -C -e 2
\&  1) Shape: [[][]]  Score: -40.70  Ratio of MFE: 0.96
\&  >seq1
\&          CACACAAAGGCAGCGGAACCCCCCUCCUGGUAACAGGAGCCU
\&  -12.30  .......((((...((....))..(((((....)))))))))  [[][]]  R = 1
\&  >seq2
\&          AGGCAGCGGAAAUCCCCACCUGGUAACAGGUGCCUCUGC
\&  -13.10  ..((((.((....)).((((((....))))))...))))  [[][]]  R = 2
\&  >seq3
\&          CCUUUGCAGGCAGCGGAAUCCCCCACCUGGUGACAGGUGCCU
\&  -15.30  .......((((...((....))..(((((....)))))))))  [[][]]  R = 1
.Ve
.PP
To get more results, increase energy range with \fB\-e\fR or \fB\-c\fR.
.PP
We propose to use the output of the consensus shapes analysis as input
for RNAforester (Hoechsmann et al., 2004), a multiple \s-1RNA\s0 structure
alignment program. Use output type \fB\-o\fR f together with option \fB\-C\fR
to generate suitable input for RNAforester. For example:
.PP
.Vb 1
\&  RNAshapes -f test.fasta -C -o f | RNAforester -m
.Ve
.PP
Note that with output type \fB\-o\fR f only the result for the first
consensus is printed (otherwise RNAforester would not work
properly). Use the shape match option \fB\-m\fR to get alternative
results. RNAforester is now part of the Vienna \s-1RNA\s0 package and can be
downloaded at http://www.tbi.univie.ac.at/~ivo/RNA/.
.Sh "Additional modes (use with any of the above)"
.IX Subsection "Additional modes (use with any of the above)"
\&\fB\-r\fR  Calculate structure probabilities
.PP
This calculates the probability of every computed structure. It can be
combined with any sequence analysis mode. Note that this option
increases processing time of modes \fB\-a\fR, \fB\-s\fR and \fB\-C\fR.
.PP
\&\fB\-w\fR \f(CW\*(C`value\*(C'\fR  Specify window size
.PP
Beginning with position 1 of the input sequence, the analysis is
repeatedly processed on subsequences of the specified size. After each
calculation, the results are printed out and the window is moved by
the window position increment (\fB\-W\fR), until the end of the input
sequence is reached.
.PP
\&\fB\-W\fR \f(CW\*(C`value\*(C'\fR  Specify window position increment (use with \fB\-w\fR) [1]
.PP
This specifies the increment for the window analysis mode (\fB\-w\fR).
.PP
\&\fB\-m\fR \f(CW\*(C`shape\*(C'\fR Match shape (use with \fB\-a\fR, \fB\-s\fR, \fB\-p\fR, \fB\-q\fR, or \fB\-C\fR)
.PP
Specify a shape for the corresponding mode of operation. For example,
with options \fB\-p\fR \fB\-m\fR '[]' the probability of shape [] is
computed.
.Sh "Analysis control"
.IX Subsection "Analysis control"
\&\fB\-e\fR \f(CW\*(C`value\*(C'\fR Set energy range (kcal/mol)
.PP
This sets the energy range for shape folding (\fB\-a\fR), complete
suboptimal folding (\fB\-s\fR), probability analysis with \fB\-P\fR, and
consensus shapes analysis (\fB\-C\fR). \f(CW\*(C`value\*(C'\fR is the difference to the
minimum free energy for the sequence.
.PP
\&\fB\-c\fR \f(CW\*(C`value\*(C'\fR Set energy range (%) [10]
.PP
This sets the energy range as percentage value of the minimum free
energy. For example, when \fB\-c\fR 10 is specified, and the minimum free
energy is \-10.0 kcal/mol, the energy range is set to \-9.0 to \-10.0
kcal/mol.
.PP
\&\fB\-t\fR \f(CW\*(C`value\*(C'\fR Specify shape type (1\-5) [5]
.PP
The shape type is the level of abstraction or dissimilarity which
defines a different shape. In general, helical regions are depicted by
a pair of opening and closing square brackets and unpaired regions are
represented as a single underscore. The differences of the shape types
are due to whether a structural element (bulge loop, internal loop,
multiloop, hairpin loop, stacking region and external loop)
contributes to the shape representation: Five types are
implemented. Their differences are shown in the following example:
.PP
.Vb 2
\&  AUCGGCGCACAGGACAUCCUAGGUACAAGGCCGCCCGUU
\&  ..(((.((..(((....))).(((.....))))))))..
.Ve
.PP
Type 5: Most abstract \- helix nesting pattern and no unpaired regions
.PP
.Vb 1
\&  [[][]]
.Ve
.PP
Type 4: helix nesting pattern and unpaired regions in external loop and multiloop
.PP
.Vb 1
\&  [[][]]
.Ve
.PP
Type 3: nesting pattern for all loop types but no unpaired regions
.PP
.Vb 1
\&  [[[][]]]
.Ve
.PP
Type 2: nesting pattern for all loop types and unpaired regions in external loop and multiloop
.PP
.Vb 1
\&  [_[[][]]]
.Ve
.PP
Type 1: Most accurate \- all loops and all unpaired
.PP
.Vb 1
\&  _[_[_[]_[]]]_
.Ve
.PP
\&\fB\-F\fR \f(CW\*(C`value\*(C'\fR Set probability cutoff filter (use with \fB\-p\fR, \fB\-q\fR or \fB\-P\fR)
.PP
This option sets a barrier for filtering out results with very low
probabilities during calculation. The default value here is 0.000001,
which gives a significant speedup compared to a disabled filter. Note
that this filter can have a slight influence on the overall
results. To disable this filter, use option \fB\-F\fR 0.
.PP
\&\fB\-T\fR \f(CW\*(C`value\*(C'\fR  Set probability output filter (use with \fB\-p\fR, \fB\-q\fR or \fB\-P\fR)
.PP
This option sets a filter for omitting low probability results during
output. Unlike \fB\-F\fR, this option does not have any influence on
probabilities beyond this value.
.PP
\&\fB\-M\fR \f(CW\*(C`value\*(C'\fR  Set maximum loop length [30]  (use \-M n for unrestricted)
.PP
This option sets the maximum lengths of the considered internal and
bulge loops. The default value here is 30. Note that this restriction
can have a very slight influence on the calculated structure and shape
probabilities. For unrestricted loop lengths, use option \fB\-M\fR n. This
will increase calculation times and memory requirements.
.PP
\&\fB\-y\fR \f(CW\*(C`value\*(C'\fR  Set minimal shape length
.PP
This option sets the minimal shape length. Subshapes smaller than
\&\f(CW\*(C`value\*(C'\fR are omitted from the analysis. 
.PP
\&\fB\-l\fR       Allow lonely base pairs
.PP
In default mode, RNAshapes only considers helices of length 2 or
longer. With option \fB\-l\fR, lonely base pairs are also included. 
.PP
\&\fB\-u\fR       Ignore unstable structures (use with \fB\-a\fR, \fB\-s\fR or \fB\-C\fR)
.PP
This option filters out closed structures with positive free
energy.  
.Sh "Input/Output"
.IX Subsection "Input/Output"
\&\fB\-o\fR \f(CW\*(C`value\*(C'\fR Specify output type (1\-4,f) [2]
.PP
Specifies the output type. Output type 1 mimics RNAfold and RNAsubopt.
Type 2 is the default RNAshapes output. Type 3 is similar to type 2,
but without parentheses and with only a single space between
results. This output type can be used for exporting results as a comma
separated text-file to other applications like Microsoft Excel. Type 4
is a colored variant of type 2. Additional output types can be defined
with option \fB\-O\fR.
.PP
In consensus shapes analysis (\fB\-C\fR), output type f can be used to
generate suitable input for RNAforester (a multiple \s-1RNA\s0 structure
alignment program; see \fB\-C\fR for details).
.PP
\&\fB\-O\fR \f(CW\*(C`string\*(C'\fR Specify output format string
.PP
The option \fB\-O\fR can be used to \*(L"fine\-tune\*(R" the format of the printed
results, for example when we are only interested in parts of the
result, or when results of RNAshapes should be used as input for other
programs. The syntax is as follows:
.PP
.Vb 1
\&  TYPE{FORMAT}...TYPE{FORMAT}
.Ve
.PP
where \s-1TYPE\s0 specifies the result element:
.PP
.Vb 7
\&  D: structure in dot-bracket notation
\&  S: shape string
\&  E: energy
\&  P: shape probability
\&  R: structure probability (option -r)
\&  C: shape rank (option -C)
\&  V: verbatim output, independent of result element
.Ve
.PP
\&\s-1FORMAT\s0 is the C\-format string that shall be used to print the
corresponding result element. Typical C\-format strings are %.2f for a
floating point number with two decimal places and \f(CW%s\fR for a string. For
example, to print only the structure followed by its energy, we can
use \-O 'D{%s\et}E{%.2f}V{\en}'. The symbol '\en' performs a line break,
the symbol '\et' a tabulator. An \s-1ANSI\s0 escape sequence can be used with
symbol '\ee' (see Example 4 below).
.PP
The standard output types (option \fB\-o\fR) are defined as follows:
.PP
.Vb 5
\&  1) 'D{%s  }E{(%.2f)  }R{(%.7f)  }P{%.7f  }S{%s}C{  R = %d}V{\en}'
\&  2) 'E{%-8.2f}R{(%.7f)  }D{%s  }P{%.7f  }S{%s}C{  R = %d}V{\en}'
\&  3) 'E{%.2f }R{%.7f }D{%s }P{%.7f }S{%s}C{ %d}V{\en}'
\&  4) 'E{%-8.2f}R{(%.7f)  }D{\ee[1;31m%s\ee[0m  }
\&      P{\ee[1;30m%.7f\ee[0m  }S{%s}C{  R = %d}V{\en}'
.Ve
.PP
\&\fB\-S\fR \f(CW\*(C`value\*(C'\fR  Specify output width for structures
.PP
This splits the structure strings into parts of the specified
length. This option is useful when displaying results for long
sequences that would otherwise not fit onto the screen.
.PP
\&\fB\-#\fR \f(CW\*(C`value\*(C'\fR  Print only the first \f(CW\*(C`value\*(C'\fR results
.PP
This option specifies the total number of results to be printed. When
this number is reached, the program terminates. Note that this option
does not reduce calculation time or memory requirements (except for
modes \fB\-s\fR and \fB\-i\fR).
.PP
\&\fB\-g\fR \f(CW\*(C`value\*(C'\fR Generate structure graphs for first \f(CW\*(C`value\*(C'\fR structures
.PP
This generates postscript structure graphs for the first \f(CW\*(C`value\*(C'\fR
structures computed for a sequence. If multiple sequences are given,
\&\f(CW\*(C`value\*(C'\fR graphs are generated for each sequence.
.PP
The filenames of the structure graphs consist of several parts:
.PP
1. When the input sequence is given in fasta format, the first 12
   characters of the sequence description are taken. White-spaces and
   special characters are removed. When no description is available,
   \*(L"rna\*(R" is chosen as standard name.
.PP
2. The sequence position in window mode (option \fB\-w\fR).
.PP
3. The running number of the result.
.PP
For example, the first result of a sequence called \*(L"xyz\*(R" at position 7
in window mode will be saved in file xyz_7_1.ps.
.PP
\&\fB\-L\fR        Highlight uppercase characters in structure graphs
.PP
Used with option \fB\-g\fR, this generates postscript structure graphs
where all uppercase characters in the input sequence are
highlighted. This option is useful for marking interesting regions of
the input sequence.
.PP
\&\fB\-N\fR        Do not include additional information in graph output file
.PP
In standard operation, the postscript structure graph generation
(option \fB\-g\fR) generates files with shape, energy, and shape
probability (if available) included at the bottom. Use this option to
suppress this.
.PP
\&\fB\-A\fR        Omit samples in output
.PP
Omit output of samples in sampling mode (\fB\-i\fR)
.PP
\&\fB\-f\fR \f(CW\*(C`file\*(C'\fR   Read input from \f(CW\*(C`file\*(C'\fR
.PP
Let RNAshapes load its input data from \f(CW\*(C`file\*(C'\fR.  \f(CW\*(C`file\*(C'\fR can
contain a plain single sequence, or multiple sequences in fasta
format. When given multiple sequences, each sequence is processed
separately in the order of input.
.PP
Valid characters in an input sequence are \*(L"\s-1ACGU\s0\*(R" and \*(L"acgu\*(R". \*(L"T\*(R" and
\&\*(L"t\*(R" will be converted to \*(L"U\*(R". Other letters are mapped to \*(L"N\*(R" and will
not be paired. All other characters are ignored.
.PP
\&\fB\-B\fR       Show progress bar (use with \fB\-p\fR, \fB\-q\fR or \fB\-P\fR)
.PP
Setting this option activates a progress bar. This is useful when
experimenting with options \fB\-p\fR and \fB\-q\fR, to get an impression of
the expected running time.
.PP
\&\fB\-z\fR          Enable colors (in interactive mode: disable colors)
.PP
This option enables colored output. In interactive mode, this is the
default setting, so use \fB\-z\fR to disable colors here.
.PP
\&\fB\-Z\fR          Enable colors for dotbracket and shape strings
.PP
This option colors dotbracket and shape strings in the result output,
such that corresponding structural elements have the same color in
both representations.
.PP
\&\fB\-D\fR \f(CW\*(C`string\*(C'\fR  Convert dotbracket-string to shape (choose type with \fB\-t\fR)
.PP
Convert a dotbracket-string into a shape. Choose the shape type with
option \fB\-t\fR. The default shape type is 5. For example:
.PP
.Vb 2
\&  RNAshapes -D '.((((.(((....))).))))...(((....))).' -t 4
\&  _[]_[]_
.Ve
.PP
\&\fB\-U\fR          Start graphical user interface
.PP
This option starts the graphical user interface included in the
RNAshapes distribution. It requires Java 1.4.2 or later (download from
http://java.sun.com/). Note that the RNAshapes distribution for
Microsoft Windows includes a slightly different user interface. 
It does not require Java and additionaly, it offers an interactive
visualization of the calculated \s-1RNA\s0 structures.
.Sh "Additional interactive mode commands"
.IX Subsection "Additional interactive mode commands"
\&\fB:s\fR          Show current configuration
.PP
This command shows the current settings in an interactive session. 
.PP
\&\fB:d\fR           Reset configuration
.PP
This command sets all settings to their default values. 
.PP
\&\fB:e\fR \f(CW\*(C`string\*(C'\fR Execute system command
.PP
Command \fB:e\fR executes a system command. For example, we can use the
command \fB:e\fR gv rna_1.ps to open a structure graph file created with
option \fB\-g\fR (on a unix machine with gv installed).
.PP
\&\fB:q\fR           Quit
.PP
This command quits an interactive RNAshapes session.
.SH "EXAMPLES"
.IX Header "EXAMPLES"
Calculate shapes based on free energy minimization:
.PP
.Vb 1
\&    RNAshapes GAGCCTGGGAGCTCTCTGGCTAACTGGGAACCCACTGCTTAAGCC
.Ve
.PP
Pipe file \fIinput.seq\fR into the program:
.PP
.Vb 1
\&    RNAshapes < input.seq
.Ve
.PP
Calculate probabilities for input sequences:
.PP
.Vb 1
\&    RNAshapes -p < input.seq
.Ve
.PP
Calculate probabilities for the 5 energetically best shapes, using an
energy range up to 30% of the minimum free energy. Generate structure
graphs for the first three structures of each sequence:
.PP
.Vb 1
\&    RNAshapes -P 5 -c 30 -g 3 < input.seq
.Ve
.PP
Calculate probability of shape _[]_[]_[]_, using shape type 4:
.PP
.Vb 1
\&    RNAshapes -p -m _[]_[]_[]_ -t 4 < input.seq
.Ve
.PP
Calculate probability of shape [], using a window of size 100:
.PP
.Vb 1
\&    RNAshapes -p -m [] -w 100 < input.seq
.Ve
.PP
\&\fBSee more examples in the RNAshapes user's manual (RNAshapes.pdf)\fR.
.SH "EXIT STATUS"
.IX Header "EXIT STATUS"
RNAshapes returns a zero exit status if it succeeds. Non zero is
returned in case of failure.
.SH "AUTHORS"
.IX Header "AUTHORS"
Copyright (C) 2005\-2006 Peter Steffen, Bjoern Voss, Jens Reeder,
Marc Rehmsmeier, Robert Giegerich.
.PP
\&\s-1PS\s0, \s-1JR\s0, \s-1RG:\s0 Faculty of Technology, Bielefeld University, 33594
Bielefeld, Germany
.PP
\&\s-1BV:\s0 Institute of Biology \s-1II\s0, Experimental Bioinformatics, Freiburg
University, Schaenzlestr. 1, 79104 Freiburg, Germany
.PP
\&\s-1MR:\s0 Center for Biotechnology (CeBiTec), Bielefeld University, 33594
Bielefeld, Germany
.PP
Send comments/bug reports to: P.Steffen <psteffen@techfak.uni\-bielefeld.de>.
.PP
Updates: http://bibiserv.techfak.uni\-bielefeld.de/rnashapes/
.PP
\&\fBRNAshapes contains code from the following contributors:\fR
.PP
\&\fBStructure graph output:\fR
Vienna \s-1RNA\s0 Package, version 1.5.
Copyright (C) Ivo Hofacker, Peter Stadler, Walter Fontana, Stefan Wuchty.  
Institute for Theoretical Chemistry of the University of Vienna.
Based on \s-1NAVIEW\s0, Copyright (C) 1988 Robert E. Bruccoleri
.PP
\&\fBRandom number generator \s-1MT19937:\s0\fR
Copyright (C) 1997\-2002, Makoto Matsumoto and Takuji Nishimura,
All rights reserved.
.PP
\&\fBEditline library (libedit):\fR
Copyright (C) 1997\-2003 The NetBSD Foundation, Inc.
All rights reserved.
.SH "REFERENCES"
.IX Header "REFERENCES"
P. Steffen, B. Voss, M. Rehmsmeier, J. Reeder and
R. Giegerich. RNAshapes: an integrated \s-1RNA\s0 analysis package based on
abstract shapes. Bioinformatics (2005), Epub ahead of print.
.PP
R. Giegerich, B. Voss and M. Rehmsmeier. Abstract Shapes of \s-1RNA\s0.
Nucl. Acids Res. (2004), Vol.32, pp. 4843\-4851.
.PP
M. Hoechsmann, B. Voss and R. Giegerich. Pure Multiple \s-1RNA\s0 Secondary
Structure Alignments: A Progressive Profile Approach. \s-1IEEE/ACM\s0
Transactions on Computational Biology and Bioinformatics (2004),
\&\fIVol.1\fR\|(1), pp. 53\-62.
.PP
I.L. Hofacker, W. Fontana, P.F. Stadler, L.S. Bonhoeffer, M. Tacker
and P.Schuster. Fast folding and comparison of \s-1RNA\s0 secondary
structures. Monatshefte f. Chemie (1994), Vol.125, pp. 167\-188.
.PP
J. Reeder and R. Giegerich. Consensus shapes: an alternative to the
Sankoff algorithm for \s-1RNA\s0 consensus structure prediction.
Bioinformatics (2005), Vol.21(17), pp. 3516\-3523.
.PP
D. Sankoff. Simultaneous Solution of the \s-1RNA\s0 Folding, Alignment and
Protosequence Problems. \s-1SIAM\s0 J. Appl Math (1985), \fIVol.45\fR\|(5),
pp. 810\-825.
.PP
B. Voss, R. Giegerich and M. Rehmsmeier. Complete Probabilistic
Analysis of \s-1RNA\s0 Shapes. Manuscript under review. (2005).
